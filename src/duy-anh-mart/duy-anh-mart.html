<template>
  <require from="./value-converter/addCommaToView"></require>

  <div class="duyAnhMart">
    <!-- instruction box -->
    <div class="instructionBoxContainer">
      <div>
        <div class="instructionBox">
          Th√¥ng tin: &nbsp;
          <!-- No Product code -->
          <span if.bind="!productCode && currentProduct.price === undefined">
            <em> üì¢ &nbsp; ƒêang ch·ªù ch·ª•p code (·∫•n ESC ƒë·ªÉ ch·ª•p) üì¢ </em>
          </span>
          <!-- Product code, but no prce -->
          <span if.bind="productCode && currentProduct.price === undefined">
            <em> ‚ö†Ô∏èÔ∏è &nbsp; Ch∆∞a t√¨m th·∫•y gi√° ‚ö†Ô∏è </em>
          </span>
          <span if.bind="currentProduct.price !== undefined">
            <em> üéé &nbsp; ƒêang thanh to√°n cho kh√°ch üéé </em>
          </span>
        </div>
      </div>
    </div>

    <div class="appContainer">
      <!-- Enter price and manage -->
      <div class="leftContainer">
        <h2>üîé T√¨m gi√°</h2>
        <div class="findProductContainer">
          <input
            ref="productCodeInputRef"
            class="scannerInput"
            type="text"
            autofocus
            value.bind="productCode"
            placeholder="Ch·ª•p code m·∫∑t h√†ng"
          />
          <div class="productContainer">
            <div class="productPriceContainer">
              <!-- <label>Gia:</label> -->
              <span class="productPrice__currency">VND</span>
              <template if.bind="currentProduct.price">
                <strong class="productPrice__value"
                  >${currentProduct.price.toLocaleString("en")}</strong
                >
              </template>
              <!-- No price -->
              <span class="productPrice__notFound" if.bind="priceNotFound"
                >‚ö†Ô∏è Ko t√¨m th·∫•y gi√°</span
              >
            </div>
            <span class="productName">${currentProduct.name}</span>
            <!-- <div class="amountForProductContainer">
              <label for="amountForProduct">So Luong</label>
              <input
                ref="amountForProductRef"
                type="number"
                id="amountForProduct"
                value.bind="amountForProduct"
              />
            </div> -->
          </div>
        </div>
        <!-- Them mat hang -->
        <div
          show.bind="priceNotFound"
          class="manageProductsContainer ${priceNotFound ? '' : 'disabled'}"
        >
          <h4>‚ûï‚ûï &nbsp; Th√™m m·∫∑t h√†ng &nbsp; ‚ûï ‚ûï </h4>
          <div class="addNewProductContainer">
            <div>
              <label for="">T√™n</label>
              <input
                ref="newProductNameInputRef"
                class="newProductName"
                type="text"
                disabled.bind="!priceNotFound"
                value.bind="newProductName"
              />
            </div>
            <div>
              <label for="">Gi√° m·ªõi</label>
              <input
                ref="newProductPriceInputRef"
                type="number"
                disabled.bind="!priceNotFound"
                value.bind="newProductPrice"
              />
              <!-- disabled.bind="!priceNotFound" -->
              <label for="addThousandInput">1000 VND</label>
            </div>
            <button
              disabled.bind="!priceNotFound"
              click.delegate="addNewProduct()"
            >
              Them
            </button>
          </div>
          <div if.bind="newlyAddedProduct" class="newlyAddedContainer">
            ‚úÖ ƒë√£ th√™m <strong>"${newlyAddedProduct.name}"</strong> th√†nh c√¥ng
            v·ªõi gi√°
            <strong>"${newlyAddedProduct.price.toLocaleString("en")}"</strong>
            VND
          </div>
        </div>
        <!-- Sua gia -->
        <div
          show.bind="canEditPrice"
          class="existingProductContainer ${canEditPrice ? '' : 'disabled'}"
        >
          <h4>‚úèÔ∏èÔ∏è‚úèÔ∏è &nbsp; S·ª≠a gi√° &nbsp; ‚úèÔ∏è‚úèÔ∏è</h4>
          <div>
            <label for="">VND</label>
            <input
              ref="updateProductPriceRef"
              disabled.bind="!canEditPrice"
              type="text"
              value.bind="updatedProductPrice | addCommaToView"
            />
          </div>
          <div class="updateProduct__name">
            <label for="">T√™n</label>
            <input
              ref="updateProductNameRef"
              disabled.bind="!canEditPrice"
              type="text"
              value.bind="updatedProductName"
            />
          </div>
          <button
            disabled.bind="!canEditPrice"
            click.delegate="updateProduct()"
          >
            S·ª≠a gi√° m·∫∑t h√†ng
          </button>
          <button
            class="deleteProductButton"
            disabled.bind="!canEditPrice"
            click.delegate="deleteProduct()"
          >
            üóëÔ∏è B·ªè h√†ng n√†y ƒëi
          </button>
          <div if.bind="showUpdatedMessage">
            ‚úÖ ƒë√£ s·ª≠a <strong>"${updatedProductName}"</strong> th√†nh c√¥ng v·ªõi
            gi√°
            <strong>"${updatedProductPrice.toLocaleString("en")}"</strong> VND
          </div>
        </div>
        <!-- <hr />
        <hr />
        <h3>Danh Ba</h3> -->
      </div>
      <!-- Calculate Session -->
      <div class="rightContainer">
        <h2>H√≥a ƒê∆°n</h2>
        <div class="sessionContainer">
          <div class="currentSessionContainer">
            <!-- table header -->
            <div class="sessionProduct__tableHeader">
              <div class="sessionProduct__header--numbering">TT</div>
              <div class="sessionProduct__header--name">T√™n</div>
              <div class="sessionProduct__header--amount">S.l∆∞·ª£ng</div>
              <!-- <div class="sessionProduct__header">Gio</div> -->
              <!-- <div class="sessionProduct__header--code">Code</div> -->
              <div class="sessionProduct__header--price">D.gi√°</div>
              <div class="sessionProduct__header--price">T.ti·ªÅn</div>
            </div>
            <!-- table body -->
            <div
              repeat.for="sessionProduct of sessionCollection"
              class="sessionProduct"
            >
              <div class="sessionProduct__code--numbering">${$index + 1}</div>
              <!-- name -->
              <div class="sessionProduct__code--name">
                ${sessionProduct.name}
              </div>
              <!-- amount -->
              <div class="sessionProduct__code--amount">
                <input
                  ref="amountForProductRef"
                  class="sessionProduct__amount"
                  type="number"
                  value.bind="sessionProduct.count"
                  change.delegate="calculateSessionSum()"
                />
              </div>
              <!-- time -->
              <!-- <div class="sessionProduct__code--"> ${sessionProduct.time} </div> -->
              <!-- code -->
              <!-- <div class="sessionProduct__code--code">${sessionProduct.code}</div> -->
              <!-- price -->
              <div class="sessionProduct__code--price">
                ${(sessionProduct.price).toLocaleString("en")}
              </div>
              <div class="sessionProduct__code--priceTotal">
                ${(sessionProduct.price *
                sessionProduct.count).toLocaleString("en")}
              </div>
              <!-- timestamp -->
            </div>
          </div>
          <div class="sessionFooter">
            <div class="sessionSum">
              VND
              <strong>${sessionSum.toLocaleString("en")}</strong>
            </div>
            <!-- <div class="deleteButtonContainer">
              <button click.delegate="clearSessiondiv>Xoa</button>
            </div> -->
          </div>
        </div>
      </div>
    </div>
  </div>

  <label class="item" for="uploadDatabase" style="color: #aaa">Upload</label>
  <input
    type="file"
    id="uploadDatabase"
    name="avatar"
    accept="application/json"
    files.bind="uploadedDatabaseJson"
    style="display: none"
    change.delegate="dev_uploadDatabaseJson()"
  />
</template>
