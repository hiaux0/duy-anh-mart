<template>
  <require from="./value-converter/addCommaToView"></require>

  <div class="duyAnhMart">
    <div class="topContainer">
      <!-- instruction box -->
      <div class="instructionBoxContainer">
        <div>
          <div class="instructionBox">
            Th√¥ng tin: &nbsp;
            <!-- No Product code -->
            <span if.bind="!productCode && currentProduct.price === undefined">
              <em> üì¢ &nbsp; ƒêang ch·ªù ch·ª•p code (nh·∫•n ESC ƒë·ªÉ ch·ª•p) üì¢ </em>
            </span>
            <!-- Product code, but no prce -->
            <span if.bind="productCode && currentProduct.price === undefined">
              <em> ‚ö†Ô∏èÔ∏è &nbsp; Ch∆∞a t√¨m th·∫•y gi√° ‚ö†Ô∏è </em>
            </span>
            <span if.bind="currentProduct.price !== undefined">
              <em> üéé &nbsp; ƒêang thanh to√°n cho kh√°ch üéé </em>
            </span>
          </div>
        </div>
      </div>

      <!-- help -->
      <div ref="helpLabelRef" class="helpLabel" click.delegate="toggleHelp()">
        <span> ‚ùî Gi√∫p </span>
      </div>
      <div class="helpContainer">
        <div
          class="helpContent"
          show.bind="showHelpContent"
          ref="helpContentRef"
        >
          <div>
            <h4>Ch·ª•p Code H√†ng</h4>
            <ol>
              <li>Tr∆∞·ªõc khi ch·ª•p</li>
              <ol>
                <ol>
                  <li>üñ±Ô∏è D√πng chu·ªôt</li>
                  <ol>
                    <li>"üîé T√¨m gi√°" ph√≠a b√™n ph·∫£i</li>
                    <li>Nh·∫•n v√†o "Ch·ª•p code s·∫£n ph·∫©m "</li>
                  </ol>
                  <li>‚å®Ô∏è D√πng b√†n ph√≠m</li>
                  <ol>
                    <li>Ho·∫∑c l√† nh·∫•n n√∫t "ESC"</li>
                  </ol>
                </ol>
              </ol>

              <li>D√πng m√°y ch·ª•p ƒë·ªÉ ch·ª•p code</li>
            </ol>
          </div>
          <div>
            <h4>Th√™m S·∫£n ph·∫©m</h4>
            <ol>
              <li>Khi ch·ª•p code ko ra gi√°</li>
              <li>B·∫°n c√≥ th·ªÉ th√™m gi√° ·ªü ph·∫ßn d∆∞·ªõi "üîé T√¨m gi√°</li>
              <li>G√µ t√™n</li>
              <li>G√µ g√≠a</li>
              <li>Th√™m</li>
              <ol>
                <li>Nh·∫•n ph√≠m "NH·∫¨P"</li>
                <li>Ho·∫°c nh·∫•n n√∫t "Th√™m"</li>
              </ol>
            </ol>
          </div>
          <div>
            <h4>S·ª≠a Gi√°</h4>
            <ol>
              <li>Gi√° v√† t√™n s·∫£n ph·∫©m</li>
              <li>Ch·ªânh t√™n</li>
              <li>Ch·ªânh g√≠a</li>
              <li>S·ª≠a</li>
              <ol>
                <li>Nh·∫•n ph√≠m "NH·∫¨P"</li>
                <li>Ho·∫°c nh·∫•n n√∫t "S·ª≠a gi√° s·∫£n ph·∫©m "</li>
              </ol>
            </ol>
          </div>
        </div>
      </div>
    </div>

    <div class="appContainer">
      <!-- Enter price and manage -->
      <div class="leftContainer">
        <h2>üîé T√¨m gi√°</h2>
        <div class="findProductContainer">
          <input
            ref="productCodeInputRef"
            class="scannerInput"
            type="text"
            autofocus
            value.bind="productCode"
            placeholder="Ch·ª•p code s·∫£n ph·∫©m "
          />
          <div class="productContainer">
            <div class="productPriceContainer">
              <!-- <label>Gia:</label> -->
              <span class="productPrice__currency">VND</span>
              <template if.bind="currentProduct.price">
                <strong class="productPrice__value"
                  >${currentProduct.price.toLocaleString("en")}</strong
                >
              </template>
              <!-- No price -->
              <span class="productPrice__notFound" if.bind="priceNotFound"
                >‚ö†Ô∏è Ko t√¨m th·∫•y gi√°</span
              >
            </div>
            <span class="productName">${currentProduct.name}</span>
            <!-- <div class="amountForProductContainer">
              <label for="amountForProduct">So Luong</label>
              <input
                ref="amountForProductRef"
                type="number"
                id="amountForProduct"
                value.bind="amountForProduct"
              />
            </div> -->
          </div>
        </div>
        <!-- Them mat hang -->
        <div
          show.bind="priceNotFound"
          class="manageProductsContainer ${priceNotFound ? '' : 'disabled'}"
        >
          <h4>‚ûï‚ûï &nbsp; Th√™m s·∫£n ph·∫©m &nbsp; ‚ûï ‚ûï</h4>
          <div class="addNewProductContainer">
            <div>
              <label for="">T√™n</label>
              <input
                ref="newProductNameInputRef"
                class="newProductName"
                type="text"
                disabled.bind="!priceNotFound"
                value.bind="newProductName"
              />
            </div>
            <div>
              <label for="">Gi√° m·ªõi</label>
              <input
                ref="newProductPriceInputRef"
                type="number"
                disabled.bind="!priceNotFound"
                value.bind="newProductPrice"
              />
              <!-- disabled.bind="!priceNotFound" -->
              <label for="addThousandInput">1000 VND</label>
            </div>
            <button
              disabled.bind="!priceNotFound"
              click.delegate="addNewProduct()"
            >
              Th√™m
            </button>
          </div>
          <div if.bind="newlyAddedProduct" class="newlyAddedContainer">
            ‚úÖ ƒë√£ th√™m <strong>"${newlyAddedProduct.name}"</strong> th√†nh c√¥ng
            v·ªõi gi√°
            <strong>"${newlyAddedProduct.price.toLocaleString("en")}"</strong>
            VND
          </div>
        </div>
        <!-- Sua gia -->
        <div
          show.bind="canEditPrice"
          class="existingProductContainer ${canEditPrice ? '' : 'disabled'}"
        >
          <h4>‚úèÔ∏èÔ∏è‚úèÔ∏è &nbsp; S·ª≠a gi√° &nbsp; ‚úèÔ∏è‚úèÔ∏è</h4>
          <div>
            <label for="">Gi√°</label>
            <input
              ref="updateProductPriceRef"
              disabled.bind="!canEditPrice"
              type="text"
              value.bind="updatedProductPrice | addCommaToView"
            />
          </div>
          <div class="updateProduct__name">
            <label for="">T√™n</label>
            <input
              ref="updateProductNameRef"
              disabled.bind="!canEditPrice"
              type="text"
              value.bind="updatedProductName"
            />
          </div>
          <button
            disabled.bind="!canEditPrice"
            click.delegate="updateProduct()"
          >
            S·ª≠a gi√° s·∫£n ph·∫©m
          </button>
          <button
            class="deleteProductButton"
            disabled.bind="!canEditPrice"
            click.delegate="deleteProduct()"
          >
            üóëÔ∏è B·ªè h√†ng n√†y ƒëi
          </button>
          <div if.bind="showUpdatedMessage">
            ‚úÖ ƒë√£ s·ª≠a <strong>"${updatedProductName}"</strong> th√†nh c√¥ng v·ªõi
            gi√°
            <strong>"${updatedProductPrice.toLocaleString("en")}"</strong> VND
          </div>
        </div>
        <!-- <hr />
        <hr />
        <h3>Danh Ba</h3> -->
      </div>
      <!-- Calculate Session -->
      <div class="rightContainer">
        <h2>H√≥a ƒê∆°n</h2>
        <div class="sessionContainer">
          <div class="currentSessionContainer">
            <!-- table header -->
            <div class="sessionProduct__tableHeader">
              <div class="sessionProduct__header--numbering">TT</div>
              <div class="sessionProduct__header--name">T√™n</div>
              <div class="sessionProduct__header--amount">S.l∆∞·ª£ng</div>
              <!-- <div class="sessionProduct__header">Gio</div> -->
              <!-- <div class="sessionProduct__header--code">Code</div> -->
              <div class="sessionProduct__header--price">D.gi√°</div>
              <div class="sessionProduct__header--price">T.ti·ªÅn</div>
            </div>
            <!-- table body -->
            <div
              repeat.for="sessionProduct of sessionCollection"
              class="sessionProduct"
              click.delegate="setCurrentProduct(sessionProduct)"
            >
              <div class="sessionProduct__code--numbering">${$index + 1}</div>
              <!-- name -->
              <div class="sessionProduct__code--name">
                ${sessionProduct.name}
              </div>
              <!-- amount -->
              <div class="sessionProduct__code--amount">
                <input
                  ref="amountForProductRef"
                  class="sessionProduct__amount"
                  type="number"
                  value.bind="sessionProduct.count"
                  change.delegate="calculateSessionSum()"
                />
              </div>
              <!-- time -->
              <!-- <div class="sessionProduct__code--"> ${sessionProduct.time} </div> -->
              <!-- code -->
              <!-- <div class="sessionProduct__code--code">${sessionProduct.code}</div> -->
              <!-- price -->
              <div class="sessionProduct__code--price">
                ${(sessionProduct.price).toLocaleString("en")}
              </div>
              <div class="sessionProduct__code--priceTotal">
                ${(sessionProduct.price *
                sessionProduct.count).toLocaleString("en")}
              </div>
              <!-- timestamp -->
            </div>
          </div>
          <div class="sessionFooter">
            <div class="sessionSum">
              VND
              <strong>${sessionSum.toLocaleString("en")}</strong>
            </div>
            <!-- <div class="deleteButtonContainer">
              <button click.delegate="clearSessiondiv>Xoa</button>
            </div> -->
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="hiddenFooterContainer">
    <div>
      <label class="item" for="uploadDatabase">Upload</label>
      <input
        type="file"
        id="uploadDatabase"
        name="avatar"
        accept="application/json"
        files.bind="uploadedDatabaseJson"
        style="display: none"
        change.delegate="dev_uploadDatabaseJson()"
      />
    </div>
    <div>
      <div click.delegate="downloadDatabase()">Download</div>
    </div>
    <div>
      <label for="">Th√™m h√†ng nhanh</label>
      <input type="checkbox" checked.bind="quickMode" />
    </div>
  </div>
</template>
